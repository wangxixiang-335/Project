<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å¸ˆå®¡æ‰¹åŠŸèƒ½å‰ç«¯æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; background: #fafafa; }
        .success { color: #10b981; font-weight: bold; }
        .error { color: #ef4444; font-weight: bold; }
        .warning { color: #f59e0b; font-weight: bold; }
        button { margin: 5px; padding: 10px 15px; cursor: pointer; border: none; border-radius: 5px; background: #667eea; color: white; font-weight: 500; }
        button:hover { background: #5a67d8; }
        #console { background: #1f2937; color: #f3f4f6; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; font-size: 14px; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
        .feature-list { background: #f0f9ff; padding: 15px; border-radius: 5px; border-left: 4px solid #3b82f6; }
        .feature-list h3 { margin-top: 0; color: #1e40af; }
        .feature-list ul { margin: 10px 0; padding-left: 20px; }
        .feature-list li { margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ æ•™å¸ˆå®¡æ‰¹åŠŸèƒ½ä¿®å¤éªŒè¯</h1>
        
        <div class="feature-list">
            <h3>âœ… å·²ä¿®å¤çš„åŠŸèƒ½</h3>
            <ul>
                <li><strong>æŸ¥çœ‹åŠŸèƒ½ï¼š</strong>ç‚¹å‡»"æ‰¹æ”¹"æŒ‰é’®ç°åœ¨ä¼šæ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…æ¨¡æ€æ¡†</li>
                <li><strong>é€šè¿‡åŠŸèƒ½ï¼š</strong>é€‰æ‹©"é€šè¿‡"é€‰é¡¹å¹¶ç¡®è®¤å¯ä»¥å®¡æ‰¹é€šè¿‡é¡¹ç›®</li>
                <li><strong>é©³å›åŠŸèƒ½ï¼š</strong>é€‰æ‹©"é©³å›"é€‰é¡¹ï¼Œè¾“å…¥åŸå› å¹¶ç¡®è®¤å¯ä»¥é©³å›é¡¹ç›®</li>
                <li><strong>ç”¨æˆ·åé¦ˆï¼š</strong>æ·»åŠ äº†æ¶ˆæ¯æç¤ºç³»ç»Ÿï¼Œæ˜¾ç¤ºæ“ä½œæˆåŠŸ/å¤±è´¥ä¿¡æ¯</li>
                <li><strong>é”™è¯¯å¤„ç†ï¼š</strong>å¢å¼ºäº†é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µå¤„ç†</li>
                <li><strong>æ•°æ®åŠ è½½ï¼š</strong>ä»åç«¯APIåŠ¨æ€åŠ è½½å¾…å®¡æ‰¹é¡¹ç›®åˆ—è¡¨</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h3>ğŸ§ª å‰ç«¯åŠŸèƒ½æµ‹è¯•</h3>
            <p>ä»¥ä¸‹æµ‹è¯•å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œï¼ŒéªŒè¯ä¿®å¤çš„åŠŸèƒ½ï¼š</p>
            <button onclick="testReviewProject()">æµ‹è¯•æŸ¥çœ‹é¡¹ç›®åŠŸèƒ½</button>
            <button onclick="testShowApprovalModal()">æµ‹è¯•å®¡æ‰¹æ¨¡æ€æ¡†</button>
            <button onclick="testMessageSystem()">æµ‹è¯•æ¶ˆæ¯æç¤ºç³»ç»Ÿ</button>
            <button onclick="testApiConnection()">æµ‹è¯•APIè¿æ¥</button>
            <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
            <div id="console">ç­‰å¾…æµ‹è¯•å¼€å§‹...</div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
            <ol>
                <li><strong>ç™»å½•æ•™å¸ˆç³»ç»Ÿï¼š</strong>è®¿é—® teacher.html é¡µé¢ï¼Œä½¿ç”¨æ•™å¸ˆè´¦å·ç™»å½•</li>
                <li><strong>è¿›å…¥å®¡æ‰¹é¡µé¢ï¼š</strong>ç‚¹å‡»å¯¼èˆªæ çš„"æˆæœå®¡æ‰¹"é€‰é¡¹</li>
                <li><strong>æŸ¥çœ‹é¡¹ç›®ï¼š</strong>ç‚¹å‡»é¡¹ç›®è¡Œçš„"æ‰¹æ”¹"æŒ‰é’®æŸ¥çœ‹è¯¦æƒ…</li>
                <li><strong>è¿›è¡Œå®¡æ‰¹ï¼š</strong>åœ¨æ¨¡æ€æ¡†ä¸­é€‰æ‹©é€šè¿‡æˆ–é©³å›ï¼Œç‚¹å‡»ç¡®è®¤</li>
                <li><strong>æŸ¥çœ‹ç»“æœï¼š</strong>ç³»ç»Ÿä¼šæ˜¾ç¤ºæ“ä½œç»“æœï¼Œå¹¶è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>âš ï¸ æ³¨æ„äº‹é¡¹</h3>
            <ul>
                <li>ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ (localhost:3000)</li>
                <li>ä½¿ç”¨æ•™å¸ˆè´¦å·ç™»å½•ç³»ç»Ÿ</li>
                <li>éœ€è¦æœ‰å¾…å®¡æ‰¹çš„é¡¹ç›®æ‰èƒ½æµ‹è¯•é€šè¿‡/é©³å›åŠŸèƒ½</li>
                <li>é©³å›æ“ä½œéœ€è¦å¡«å†™é©³å›åŸå› </li>
            </ul>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : type === 'warning' ? '#f59e0b' : '#f3f4f6';
            console.innerHTML += `[${timestamp}] <span style="color: ${color}">${message}</span>\n`;
            console.scrollTop = console.scrollHeight;
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = 'æ§åˆ¶å°å·²æ¸…ç©º\n';
        }

        function testReviewProject() {
            log('=== æµ‹è¯•æŸ¥çœ‹é¡¹ç›®åŠŸèƒ½ ===');
            
            // æ¨¡æ‹ŸteacherSystem.reviewProjectå‡½æ•°
            if (typeof window.teacherSystem !== 'undefined') {
                log('âœ… teacherSystemå¯¹è±¡å­˜åœ¨', 'success');
                
                if (typeof teacherSystem.reviewProject === 'function') {
                    log('âœ… reviewProjectå‡½æ•°å­˜åœ¨', 'success');
                    
                    try {
                        // æ¨¡æ‹Ÿè°ƒç”¨
                        teacherSystem.currentReviewId = 'test-project-123';
                        teacherSystem.showApprovalModal({
                            title: 'æµ‹è¯•é¡¹ç›®',
                            student_name: 'æµ‹è¯•å­¦ç”Ÿ',
                            created_at: new Date().toISOString(),
                            type_id: 'é¡¹ç›®',
                            description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é¡¹ç›®çš„æè¿°å†…å®¹ã€‚'
                        });
                        log('âœ… æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°è°ƒç”¨æˆåŠŸ', 'success');
                    } catch (error) {
                        log(`âŒ å‡½æ•°è°ƒç”¨å¤±è´¥: ${error.message}`, 'error');
                    }
                } else {
                    log('âŒ reviewProjectå‡½æ•°ä¸å­˜åœ¨', 'error');
                }
            } else {
                log('âŒ teacherSystemå¯¹è±¡ä¸å­˜åœ¨', 'error');
                log('â„¹ï¸  è¯·åœ¨æ•™å¸ˆç³»ç»Ÿé¡µé¢(teacher.html)ä¸­è¿è¡Œæ­¤æµ‹è¯•', 'warning');
            }
        }

        function testShowApprovalModal() {
            log('=== æµ‹è¯•å®¡æ‰¹æ¨¡æ€æ¡† ===');
            
            if (typeof window.teacherSystem !== 'undefined') {
                try {
                    teacherSystem.showApprovalModal({
                        title: 'AIæ™ºèƒ½å­¦ä¹ ç³»ç»Ÿ',
                        student_name: 'å¼ ä¸‰',
                        created_at: '2024-01-15T10:30:00Z',
                        type_id: 'é¡¹ç›®',
                        description: 'åŸºäºäººå·¥æ™ºèƒ½çš„ä¸ªæ€§åŒ–å­¦ä¹ ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ ¹æ®å­¦ç”Ÿçš„å­¦ä¹ ä¹ æƒ¯å’Œè¿›åº¦æä¾›å®šåˆ¶åŒ–çš„å­¦ä¹ å†…å®¹ã€‚'
                    });
                    log('âœ… æ¨¡æ€æ¡†æ˜¾ç¤ºæˆåŠŸ', 'success');
                    log('â„¹ï¸  è¯·åœ¨é¡µé¢ä¸ŠæŸ¥çœ‹æ˜¾ç¤ºçš„æ¨¡æ€æ¡†', 'info');
                } catch (error) {
                    log(`âŒ æ¨¡æ€æ¡†æ˜¾ç¤ºå¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ teacherSystemå¯¹è±¡ä¸å­˜åœ¨', 'error');
            }
        }

        function testMessageSystem() {
            log('=== æµ‹è¯•æ¶ˆæ¯æç¤ºç³»ç»Ÿ ===');
            
            if (typeof window.teacherSystem !== 'undefined') {
                try {
                    teacherSystem.showMessage('è¿™æ˜¯ä¸€æ¡æˆåŠŸæ¶ˆæ¯', 'success');
                    setTimeout(() => {
                        teacherSystem.showMessage('è¿™æ˜¯ä¸€æ¡é”™è¯¯æ¶ˆæ¯', 'error');
                    }, 1000);
                    setTimeout(() => {
                        teacherSystem.showMessage('è¿™æ˜¯ä¸€æ¡è­¦å‘Šæ¶ˆæ¯', 'warning');
                    }, 2000);
                    setTimeout(() => {
                        teacherSystem.showMessage('è¿™æ˜¯ä¸€æ¡æ™®é€šæ¶ˆæ¯', 'info');
                    }, 3000);
                    
                    log('âœ… æ¶ˆæ¯æç¤ºç³»ç»Ÿæµ‹è¯•å¼€å§‹', 'success');
                    log('â„¹ï¸  è¯·åœ¨é¡µé¢å³ä¸Šè§’æŸ¥çœ‹æ¶ˆæ¯æç¤º', 'info');
                } catch (error) {
                    log(`âŒ æ¶ˆæ¯ç³»ç»Ÿæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ teacherSystemå¯¹è±¡ä¸å­˜åœ¨', 'error');
            }
        }

        async function testApiConnection() {
            log('=== æµ‹è¯•APIè¿æ¥ ===');
            
            try {
                const response = await fetch('http://localhost:3000/api/review/pending', {
                    headers: {
                        'Authorization': 'Bearer test-token',
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.status === 401) {
                    log('âœ… APIè¿æ¥æ­£å¸¸ (401è®¤è¯é”™è¯¯æ˜¯é¢„æœŸçš„)', 'success');
                    log('â„¹ï¸  éœ€è¦æœ‰æ•ˆtokenæ‰èƒ½è®¿é—®API', 'info');
                } else if (response.ok) {
                    log('âœ… APIè¿æ¥æ­£å¸¸', 'success');
                } else {
                    log(`âš ï¸  APIè¿”å›çŠ¶æ€: ${response.status}`, 'warning');
                }
            } catch (error) {
                log(`âŒ APIè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                log('â„¹ï¸  è¯·ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ (localhost:3000)', 'warning');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('DOMContentLoaded', () => {
            log('ğŸš€ æ•™å¸ˆå®¡æ‰¹åŠŸèƒ½ä¿®å¤éªŒè¯é¡µé¢åŠ è½½å®Œæˆ');
            log('â„¹ï¸  è¯·åœ¨æ•™å¸ˆç³»ç»Ÿé¡µé¢(teacher.html)ä¸­æµ‹è¯•å®é™…åŠŸèƒ½');
            
            // æ£€æŸ¥teacherSystemæ˜¯å¦å­˜åœ¨
            setTimeout(() => {
                if (typeof window.teacherSystem !== 'undefined') {
                    log('âœ… teacherSystemå¯¹è±¡å·²åŠ è½½', 'success');
                } else {
                    log('âš ï¸  teacherSystemå¯¹è±¡æœªæ‰¾åˆ°', 'warning');
                    log('â„¹ï¸  è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæ­¤é¡µé¢ä¸æ˜¯æ•™å¸ˆç³»ç»Ÿé¡µé¢', 'info');
                }
            }, 1000);
        });
    </script>
</body>
</html>